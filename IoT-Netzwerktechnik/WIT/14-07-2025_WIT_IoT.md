# 14.07.2025 Â· NT Â· TRE

## Sensoren & Mikrocontroller: SR04, DHT22, ESP32-WROOM-32

**Hinweis vorab:** Neue Bauteile *nur bei getrennter Stromzufuhr (USB)* ins Steckbrett einbauen.

---

## Ãœberblick: Was passiert im Code?

- **setup():** Initialisierung der Sensoren & Definition der Pins
- **loop():** Temperatur- & Luftfeuchtigkeit auslesen, Abstand messen, seriell ausgeben
- **Dauer:** 3 Sekunden Wartezeit pro Durchlauf

---

## Verwendete Sensoren

### ðŸ”¹ DHT22 (Temperatur- & Feuchtesensor)

- Digitaler Sensor fÃ¼r Luftfeuchtigkeit & Temperatur
- RÃ¼ckgabe: float-Werte (`readHumidity()`, `readTemperature()`)
- Wichtig: nur ca. 1â€“2 Messungen pro Sekunde mÃ¶glich

### ðŸ”¹ HC-SR04 (Ultraschallsensor)

- Arbeitet nach dem Echoprinzip: Sendet Impuls (Trigger), misst Echozeit
- Abstand wird aus Echozeit berechnet: `Abstand = Dauer / 58.2`

---

## Warum ESP32?

- **3.3â€¯V Logikpegel:** Empfindlicher als z.â€¯B. Arduino Uno (5â€¯V)
- **Mehr Leistung & Speicher** als klassische Mikrocontroller
- **WLAN & Bluetooth integriert**
- **Viele digitale I/O-Pins** â€“ ideal fÃ¼r parallele Sensorverwendung
- Sehr gut geeignet fÃ¼r **IoT-Projekte**

---

## Arduino-Code (kommentiert)

// Bibliothek fÃ¼r Temperatur- und Luftfeuchtigkeitssensor DHT22  
#include "DHT.h"

// Input PINs  
#define DHTPIN 22  
#define Trigger_AusgangsPin 23 // SR04 Trigger  
#define Echo_EingangsPin 21    // SR04 Echo

// Initialisierung des DHT-Sensors  
#define DHTTYPE DHT22  
DHT dht(DHTPIN, DHTTYPE);

// Messbereich festlegen  
int maximumRange = 600;  
int minimumRange = 2;

// Variablen fÃ¼r Abstandsmessung  
int Abstand;   // UrsprÃ¼nglich "long" â€“> unnÃ¶tig, da int ausreichend ist  
long Dauer;

void setup() {  
  Serial.begin(115200);  // WICHTIG: Muss hier stehen, nicht in loop()  
  dht.begin();           // Sensor starten  
  pinMode(Trigger_AusgangsPin, OUTPUT);  
  pinMode(Echo_EingangsPin, INPUT);  
}

void loop() {  
  // Temperatur- & Feuchtemessung  
  Serial.println("---------Temperatur und Luftfeuchtigkeit (DHT22) ----------");  
  float h = dht.readHumidity();  
  float t1 = dht.readTemperature();  

  // Fehlerbehandlung  
  if (isnan(h) || isnan(t1)) {  
    Serial.println("Fehler beim Lesen des Sensors");  
    return;  
  }  

  Serial.print("Luftfeuchtigkeit: ");  
  Serial.print(h);  
  Serial.print(" %\t");  
  Serial.print("Temperatur: ");  
  Serial.print(t1);  
  Serial.print(char(186)); // Ausgabe Â°-Symbol  
  Serial.println("C ");  
  Serial.println("-----------------------------------------------------------");  

  // Abstandsmessung  
  digitalWrite(Trigger_AusgangsPin, HIGH);  
  delayMicroseconds(10);  
  digitalWrite(Trigger_AusgangsPin, LOW);  

  Dauer = pulseIn(Echo_EingangsPin, HIGH);  
  Abstand = Dauer / 58.2;  

  if (Abstand >= maximumRange || Abstand <= minimumRange) {  
    Serial.println("Abstand auÃŸerhalb des Messbereichs");  
  } else {  
    Serial.print("Der Abstand betrÃ¤gt: ");  
    Serial.print(Abstand);  
    Serial.println(" cm");  
    Serial.print("Die Dauer betrÃ¤gt: ");  
    Serial.print(Dauer);  
    Serial.println(" ms");  
  }  

  Serial.println("-----------------------------------------------------------");  
  delay(3000); // 3 Sekunden Pause  
}

---

## ErklÃ¤rung: Datenarten & Ressourcen

- `long`: 4 Byte â€“ nur nÃ¶tig bei extrem groÃŸen Zahlen
- `int`: 2 Byte â€“ vÃ¶llig ausreichend fÃ¼r cm-Messung (bis 32.767)
- Warum `Serial.begin()` **nicht in `loop()`** gehÃ¶rt:  
  Serial-Schnittstelle darf nur einmalig initialisiert werden

---

## Weitere Hinweise

- Sensoren immer **nur bei stromlosem Zustand** einbauen
- Messung von SR04 beginnt mit 10â€¯Î¼s Trigger â†’ Echo misst RÃ¼cklaufzeit
- ESP32-PIN-Zuordnung beachten â€“ Fehler = keine Ausgabe
- `delay(3000)` blockiert Mikrocontroller fÃ¼r 3 Sekunden

---

## VerstÃ¤ndnisfragen (z.â€¯B. fÃ¼r AP1)

- Was bewirkt `pulseIn()`?
- Warum wird Abstand durch 58.2 geteilt?
- Unterschied `int` vs. `long`?
- Was passiert bei fehlerhaftem DHT-Sensor?
- Was bedeutet `char(186)` in Bezug auf Â°?
- Was ist der Vorteil des ESP32 im Vergleich zum Arduino Uno?

---

Teil der FIAE-Umschulung (2025â€“2027) am BFW MÃ¼hlenbeck. Diese Notizen sind Ã¶ffentlich dokumentiert zur Wiederholung, PrÃ¼fungsvorbereitung und fÃ¼r Dritte zur Orientierung.

**Unterricht bei:** TRE (BFW MÃ¼hlenbeck, FIAE Umschulung)  
**Quelle:** Eigene Mitschrift & Unterrichtsfolien vom 14.07.2025  
**Autor:** Sean Conroy  
**Lizenz:** CC BY-NC-SA 4.0
